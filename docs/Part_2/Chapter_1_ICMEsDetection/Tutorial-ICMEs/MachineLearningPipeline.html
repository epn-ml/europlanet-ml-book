
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Machine Learning Pipeline for Automated Detection of ICMEs &#8212; The Europlanet Machine Learning Book</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="4. Summary and Discussion" href="../Summary.html" />
    <link rel="prev" title="2. Science Background - Interplanetary Coronal Mass Ejections" href="../ScienceBackground.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/Europlanet_Machine_Learning_Logo_Standard.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Europlanet Machine Learning Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Foreword.html">
   The Europlanet Machine Learning Book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  1. Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Chapter_1_Introduction/Content.html">
   1. Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  2. Basic Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Part_1/Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Part_1/Chapter_1_SupervisedClassification/Tutorial_SupervisedClassification.html">
   2. Supervised classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Part_1/Chapter_2_SupervisedRegression/Tutorial_SupervisedRegression.html">
   3. Supervised regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  3. Automatic Detection of ICMEs
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ScienceBackground.html">
   2. Science Background - Interplanetary Coronal Mass Ejections
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Machine Learning Pipeline for Automated Detection of ICMEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Summary.html">
   4. Summary and Discussion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  4. Automatic Detection of Boundaries around Mercury
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Chapter_2_MercuryBoundaries/Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Chapter_2_MercuryBoundaries/ScienceBackground.html">
   2. Science Background - Boundaries around Mercury
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Chapter_2_MercuryBoundaries/Tutorial-MercuryBoundaries/Magnetometer.html">
   3. Determination of bow-shock and magnetopause crossings in Mercurys Magnetosphere using MESSENGER data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Chapter_2_MercuryBoundaries/Summary.html">
   4. Summary and Discussion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../References/bibliography.html">
   1. References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
                title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/Part_2/Chapter_1_ICMEsDetection/Tutorial-ICMEs/MachineLearningPipeline.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
        title="Vollbildmodus"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Part_2/Chapter_1_ICMEsDetection/Tutorial-ICMEs/MachineLearningPipeline.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhalt
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation-guide">
   3.1. Installation Guide
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preprocessing">
   3.2. Data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#splitting-the-data-into-training-validation-and-testing-set">
   3.3. Splitting the data into training, validation, and testing set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resunet">
   3.4. ResUNet++
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-net">
     3.4.1. U-Net
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#residual-units">
     3.4.2. Residual Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#squeeze-and-excitation-units">
     3.4.3. Squeeze and Excitation Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atrous-spatial-pyramidal-pooling">
     3.4.4. Atrous Spatial Pyramidal Pooling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#attention-units">
     3.4.5. Attention Units
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation">
   3.5. Evaluation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precision">
     3.5.1. Precision
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recall">
     3.5.2. Recall
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-iou">
     3.5.3. Mean IoU
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dice-coefficient">
     3.5.4. Dice Coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#true-skill-score">
     3.5.5. True Skill Score
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Machine Learning Pipeline for Automated Detection of ICMEs</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Inhalt </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation-guide">
   3.1. Installation Guide
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preprocessing">
   3.2. Data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#splitting-the-data-into-training-validation-and-testing-set">
   3.3. Splitting the data into training, validation, and testing set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resunet">
   3.4. ResUNet++
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-net">
     3.4.1. U-Net
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#residual-units">
     3.4.2. Residual Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#squeeze-and-excitation-units">
     3.4.3. Squeeze and Excitation Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atrous-spatial-pyramidal-pooling">
     3.4.4. Atrous Spatial Pyramidal Pooling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#attention-units">
     3.4.5. Attention Units
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation">
   3.5. Evaluation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precision">
     3.5.1. Precision
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recall">
     3.5.2. Recall
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-iou">
     3.5.3. Mean IoU
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dice-coefficient">
     3.5.4. Dice Coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#true-skill-score">
     3.5.5. True Skill Score
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="machine-learning-pipeline-for-automated-detection-of-icmes">
<h1><span class="section-number">3. </span>Machine Learning Pipeline for Automated Detection of ICMEs<a class="headerlink" href="#machine-learning-pipeline-for-automated-detection-of-icmes" title="Permalink to this headline">¶</a></h1>
<p>The work package “Machine Learning Solutions for Data Analysis and Exploitation in Planetary Science” within Europlanet 2024 Research Infrastructure will develop machine learning (ML) powered data analysis and exploitation tools optimized for planetary science. <br>
In this tutorial, we will introduce a ML pipeline for the automated detection of interplanetary coronal mass ejections (ICMEs) in solar wind time series data. We will guide the reader through the developed ML code with the help of a sample data set of solar wind time series data from different spacecraft. (WIND, STEREO-A and STEREO-B) <br></p>
<p>Europlanet 2024 RI has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 871149. <br><br></p>
<p>We propose a pipeline using a UNet including residual blocks, squeeze and excitation blocks, Atrous Spatial Pyramidal Pooling (ASPP) and attention blocks, similar to the <a class="reference external" href="https://arxiv.org/pdf/1911.07067.pdf">ResUNet++</a>, for the automatic detection of ICMEs. The original model was used for medical image segmentation, while we are dealing with time series and therefore face a slightly different use case. <br> <br></p>
<div class="section" id="installation-guide">
<h2><span class="section-number">3.1. </span>Installation Guide<a class="headerlink" href="#installation-guide" title="Permalink to this headline">¶</a></h2>
<p>This pipeline runs on Python 3.6 <br> <br></p>
<p>git clone <a class="reference external" href="https://github.com/epn-ml/Tutorial_IWF-ICMEs.git">https://github.com/epn-ml/Tutorial_IWF-ICMEs.git</a>  <br>
python -m venv wsenv <br>
source wsenv/bin/activate <br>
cd Tutorial_IWF-ICMEs <br>
pip install -r requirements.txt <br>
ipython kernel install –user –name=wsenv <br>
jupyter lab <br> <br></p>
</div>
<div class="section" id="data-preprocessing">
<h2><span class="section-number">3.2. </span>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at first, we want to import the necessary packages</span>

<span class="c1"># Don&#39;t print warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pds</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.metrics</span> <span class="kn">import</span> <span class="n">Precision</span><span class="p">,</span> <span class="n">Recall</span><span class="p">,</span> <span class="n">MeanIoU</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">Nadam</span><span class="p">,</span> <span class="n">SGD</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span><span class="p">,</span> <span class="n">ModelCheckpoint</span><span class="p">,</span> <span class="n">ReduceLROnPlateau</span><span class="p">,</span> <span class="n">CSVLogger</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">CustomObjectScope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">x3</span><span class="o">/</span><span class="mi">2</span><span class="n">bzh843n0tv469w6l6sd8sq00000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_86977</span><span class="o">/</span><span class="mf">1057536613.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> 
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">from</span> <span class="nn">tensorflow.keras.metrics</span> <span class="kn">import</span> <span class="n">Precision</span><span class="p">,</span> <span class="n">Recall</span><span class="p">,</span> <span class="n">MeanIoU</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">Nadam</span><span class="p">,</span> <span class="n">SGD</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tensorflow&#39;
</pre></div>
</div>
</div>
</div>
<p>You need to download the complete <a class="reference external" href="https://doi.org/10.6084/m9.figshare.12058065.v8">dataset</a> and <a class="reference external" href="https://doi.org/10.6084/m9.figshare.6356420.v6">event catalog</a> and place it in the folder ‘data’! We start the pipeline by loading and preprocessing the data and catalogs. The module ‘event’ is used to further process the event catalog, listing start and endtime for each event.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">event</span> <span class="k">as</span> <span class="nn">evt</span>

<span class="c1"># load ICME catalog data</span>

<span class="p">[</span><span class="n">ic</span><span class="p">,</span><span class="n">header</span><span class="p">,</span><span class="n">parameters</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/HELCATS_ICMECAT_v20_pandas.p&#39;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span> <span class="p">))</span>


<span class="c1"># extract important values</span>

<span class="n">isc</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;sc_insitu&#39;</span><span class="p">]</span> 
<span class="n">starttime</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;icme_start_time&#39;</span><span class="p">]</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;mo_end_time&#39;</span><span class="p">]</span>

<span class="c1"># Event indices from Wind, STEREO A and STEREO B</span>

<span class="n">iwinind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">isc</span> <span class="o">==</span> <span class="s1">&#39;Wind&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">istaind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">isc</span> <span class="o">==</span> <span class="s1">&#39;STEREO-A&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">istbind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">isc</span> <span class="o">==</span> <span class="s1">&#39;STEREO-B&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">winbegin</span> <span class="o">=</span> <span class="n">starttime</span><span class="p">[</span><span class="n">iwinind</span><span class="p">]</span>
<span class="n">winend</span> <span class="o">=</span> <span class="n">endtime</span><span class="p">[</span><span class="n">iwinind</span><span class="p">]</span>

<span class="n">stabegin</span> <span class="o">=</span> <span class="n">starttime</span><span class="p">[</span><span class="n">istaind</span><span class="p">]</span>
<span class="n">staend</span> <span class="o">=</span> <span class="n">endtime</span><span class="p">[</span><span class="n">istaind</span><span class="p">]</span>

<span class="n">stbbegin</span> <span class="o">=</span> <span class="n">starttime</span><span class="p">[</span><span class="n">istbind</span><span class="p">]</span>
<span class="n">stbend</span> <span class="o">=</span> <span class="n">endtime</span><span class="p">[</span><span class="n">istbind</span><span class="p">]</span>

<span class="c1"># get list of events</span>

<span class="n">evtListw</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">read_cat</span><span class="p">(</span><span class="n">winbegin</span><span class="p">,</span> <span class="n">winend</span><span class="p">,</span> <span class="n">iwinind</span><span class="p">)</span>
<span class="n">evtLista</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">read_cat</span><span class="p">(</span><span class="n">stabegin</span><span class="p">,</span> <span class="n">staend</span><span class="p">,</span> <span class="n">istaind</span><span class="p">)</span>
<span class="n">evtListb</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">read_cat</span><span class="p">(</span><span class="n">stbbegin</span><span class="p">,</span> <span class="n">stbend</span><span class="p">,</span> <span class="n">istbind</span><span class="p">)</span>

<span class="c1"># Load Wind data</span>
<span class="p">[</span><span class="n">win</span><span class="p">,</span> <span class="n">winheader</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/wind_2007_2021_heeq_ndarray.p&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>

<span class="c1"># Load STEREO-A data</span>
<span class="p">[</span><span class="n">sta</span><span class="p">,</span> <span class="n">atta</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/stereoa_2007_2021_sceq_ndarray.p&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>

<span class="c1"># Load STEREO-B data</span>
<span class="p">[</span><span class="n">stb</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">bheader</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/stereob_2007_2014_sceq_ndarray.p&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now that data and catalogs are loaded, we can start with the preprocessing. We convert the timestamp to a datetime object and compute some additional features. Furthermore, we resample the datasets to a 10 minute resolution in order to get rid of missing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">features</span>

<span class="c1"># pre process on the WIND data set</span>

<span class="n">datawin</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">win</span><span class="p">)</span>
<span class="n">datawin</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">datawin</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
<span class="n">datawin</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">datawin</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y/%m/</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span>
<span class="n">datawin</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datawin</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">datawin</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">datawin</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">datawin</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># compute additional features</span>

<span class="n">features</span><span class="o">.</span><span class="n">computeBetawiki</span><span class="p">(</span><span class="n">datawin</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computePdyn</span><span class="p">(</span><span class="n">datawin</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computeTexrat</span><span class="p">(</span><span class="n">datawin</span><span class="p">)</span>

<span class="c1"># resample data</span>
<span class="n">datawin</span> <span class="o">=</span> <span class="n">datawin</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># pre process on the STEREO A data set</span>

<span class="n">dataa</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sta</span><span class="p">)</span>
<span class="n">dataa</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">dataa</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
<span class="n">dataa</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dataa</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y/%m/</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span>
<span class="n">dataa</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataa</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">dataa</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">dataa</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dataa</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># compute additional features</span>

<span class="n">features</span><span class="o">.</span><span class="n">computeBetawiki</span><span class="p">(</span><span class="n">dataa</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computePdyn</span><span class="p">(</span><span class="n">dataa</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computeTexrat</span><span class="p">(</span><span class="n">dataa</span><span class="p">)</span>

<span class="c1"># resample data</span>
<span class="n">dataa</span> <span class="o">=</span> <span class="n">dataa</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># pre process on the STEREO B data set</span>

<span class="n">datab</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">stb</span><span class="p">)</span>
<span class="n">datab</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">datab</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
<span class="n">datab</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">datab</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y/%m/</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span>
<span class="n">datab</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datab</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">datab</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">datab</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">datab</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># compute additional features</span>

<span class="n">features</span><span class="o">.</span><span class="n">computeBetawiki</span><span class="p">(</span><span class="n">datab</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computePdyn</span><span class="p">(</span><span class="n">datab</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">computeTexrat</span><span class="p">(</span><span class="n">datab</span><span class="p">)</span>

<span class="c1"># resample data</span>
<span class="n">datab</span> <span class="o">=</span> <span class="n">datab</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We delete all events from the eventlist, where we do not have sufficient data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># delete empty events</span>

<span class="n">evtListw</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">clearempties</span><span class="p">(</span><span class="n">evtListw</span><span class="p">,</span><span class="n">datawin</span><span class="p">)</span>
<span class="n">evtLista</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">clearempties</span><span class="p">(</span><span class="n">evtLista</span><span class="p">,</span><span class="n">dataa</span><span class="p">)</span>
<span class="n">evtListb</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">clearempties</span><span class="p">(</span><span class="n">evtListb</span><span class="p">,</span><span class="n">datab</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With the help of the event class, we can easily plot example events for all three spacecraft:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot example event for WIND</span>

<span class="n">evtListw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datawin</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;Wind &#39;</span><span class="p">)</span>

<span class="c1"># plot example event for STEREO A</span>

<span class="n">evtLista</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">dataa</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO A &#39;</span><span class="p">)</span>

<span class="c1"># plot example event for STEREO B</span>

<span class="n">evtListb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datab</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO B &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/MachineLearningPipeline_10_0.png" src="../../../_images/MachineLearningPipeline_10_0.png" />
<img alt="../../../_images/MachineLearningPipeline_10_1.png" src="../../../_images/MachineLearningPipeline_10_1.png" />
<img alt="../../../_images/MachineLearningPipeline_10_2.png" src="../../../_images/MachineLearningPipeline_10_2.png" />
</div>
</div>
<p>Looking at the WIND dataset we can see, that we now have 10 features:</p>
<ul class="simple">
<li><p>magnetic field and components</p></li>
<li><p>velocity</p></li>
<li><p>proton density</p></li>
<li><p>proton temperature</p></li>
<li><p>beta parameter</p></li>
<li><p>dynamic pressure</p></li>
<li><p>ratio between expected temperature and proton temperature</p></li>
</ul>
<p>However, the values of these features vary in several orders of magnitude. Therefore, we’ll perform scaling to set the mean value to 0 and the standard deviation to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datawin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bx</th>
      <th>by</th>
      <th>bz</th>
      <th>bt</th>
      <th>vt</th>
      <th>np</th>
      <th>tp</th>
      <th>beta</th>
      <th>Pdyn</th>
      <th>texrat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2007-01-01 00:00:00</th>
      <td>1.223244</td>
      <td>-3.684057</td>
      <td>0.080246</td>
      <td>3.888975</td>
      <td>331.939625</td>
      <td>14.843064</td>
      <td>19413.118748</td>
      <td>0.646101</td>
      <td>2.735598e-09</td>
      <td>0.720593</td>
    </tr>
    <tr>
      <th>2007-01-01 00:10:00</th>
      <td>0.951300</td>
      <td>-4.066096</td>
      <td>0.060271</td>
      <td>4.184126</td>
      <td>330.122928</td>
      <td>14.243541</td>
      <td>18994.705795</td>
      <td>0.536584</td>
      <td>2.596340e-09</td>
      <td>0.720648</td>
    </tr>
    <tr>
      <th>2007-01-01 00:20:00</th>
      <td>0.325078</td>
      <td>-2.837958</td>
      <td>0.867163</td>
      <td>3.237512</td>
      <td>328.747382</td>
      <td>13.780732</td>
      <td>25637.551120</td>
      <td>1.314895</td>
      <td>2.491679e-09</td>
      <td>0.989950</td>
    </tr>
    <tr>
      <th>2007-01-01 00:30:00</th>
      <td>0.472819</td>
      <td>-3.130698</td>
      <td>2.199837</td>
      <td>3.867082</td>
      <td>327.870816</td>
      <td>11.593735</td>
      <td>24086.478532</td>
      <td>0.654117</td>
      <td>2.083827e-09</td>
      <td>0.939926</td>
    </tr>
    <tr>
      <th>2007-01-01 00:40:00</th>
      <td>-0.159123</td>
      <td>-1.394647</td>
      <td>1.394927</td>
      <td>2.462851</td>
      <td>329.516427</td>
      <td>12.122023</td>
      <td>28034.909930</td>
      <td>2.919348</td>
      <td>2.202596e-09</td>
      <td>1.073363</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-04-28 23:10:00</th>
      <td>-0.941782</td>
      <td>1.187671</td>
      <td>0.184250</td>
      <td>1.526914</td>
      <td>368.055969</td>
      <td>4.161323</td>
      <td>12093.222967</td>
      <td>0.748976</td>
      <td>9.428810e-10</td>
      <td>0.303752</td>
    </tr>
    <tr>
      <th>2021-04-28 23:20:00</th>
      <td>-0.941784</td>
      <td>1.187670</td>
      <td>0.184250</td>
      <td>1.526914</td>
      <td>368.055969</td>
      <td>4.161323</td>
      <td>12093.222967</td>
      <td>0.748976</td>
      <td>9.428810e-10</td>
      <td>0.303752</td>
    </tr>
    <tr>
      <th>2021-04-28 23:30:00</th>
      <td>-0.941785</td>
      <td>1.187669</td>
      <td>0.184249</td>
      <td>1.526914</td>
      <td>368.055969</td>
      <td>4.161323</td>
      <td>12093.222967</td>
      <td>0.748976</td>
      <td>9.428810e-10</td>
      <td>0.303752</td>
    </tr>
    <tr>
      <th>2021-04-28 23:40:00</th>
      <td>-0.941786</td>
      <td>1.187668</td>
      <td>0.184248</td>
      <td>1.526914</td>
      <td>368.055969</td>
      <td>4.161323</td>
      <td>12093.222967</td>
      <td>0.748976</td>
      <td>9.428810e-10</td>
      <td>0.303752</td>
    </tr>
    <tr>
      <th>2021-04-28 23:50:00</th>
      <td>-0.941788</td>
      <td>1.187667</td>
      <td>0.184248</td>
      <td>1.526914</td>
      <td>368.055969</td>
      <td>4.161323</td>
      <td>12093.222967</td>
      <td>0.748976</td>
      <td>9.428810e-10</td>
      <td>0.303752</td>
    </tr>
  </tbody>
</table>
<p>736389 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># perform scaling on WIND</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scale</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">datawin</span><span class="p">)</span>

<span class="n">wind_scaled</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">datawin</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">datawin</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">datawin</span><span class="p">))</span>

<span class="c1"># perform scaling on STEREO A</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scale</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataa</span><span class="p">)</span>

<span class="n">sta_scaled</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">dataa</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">dataa</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dataa</span><span class="p">))</span>

<span class="c1"># perform scaling on STEREO B</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scale</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">datab</span><span class="p">)</span>

<span class="n">stb_scaled</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">datab</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">datab</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">datab</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bx</th>
      <th>by</th>
      <th>bz</th>
      <th>bt</th>
      <th>vt</th>
      <th>np</th>
      <th>tp</th>
      <th>beta</th>
      <th>Pdyn</th>
      <th>texrat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2007-01-01 00:00:00</th>
      <td>0.406938</td>
      <td>-1.064839</td>
      <td>0.052577</td>
      <td>-0.428195</td>
      <td>-0.861950</td>
      <td>1.652052</td>
      <td>-0.819134</td>
      <td>-0.076034</td>
      <td>0.733165</td>
      <td>-0.088519</td>
    </tr>
    <tr>
      <th>2007-01-01 00:10:00</th>
      <td>0.319958</td>
      <td>-1.172525</td>
      <td>0.045369</td>
      <td>-0.313126</td>
      <td>-0.880919</td>
      <td>1.533749</td>
      <td>-0.824326</td>
      <td>-0.103581</td>
      <td>0.634073</td>
      <td>-0.088511</td>
    </tr>
    <tr>
      <th>2007-01-01 00:20:00</th>
      <td>0.119663</td>
      <td>-0.826348</td>
      <td>0.336545</td>
      <td>-0.682178</td>
      <td>-0.895282</td>
      <td>1.442423</td>
      <td>-0.741898</td>
      <td>0.092189</td>
      <td>0.559600</td>
      <td>-0.050420</td>
    </tr>
    <tr>
      <th>2007-01-01 00:30:00</th>
      <td>0.166918</td>
      <td>-0.908863</td>
      <td>0.817456</td>
      <td>-0.436731</td>
      <td>-0.904435</td>
      <td>1.010865</td>
      <td>-0.761144</td>
      <td>-0.074018</td>
      <td>0.269385</td>
      <td>-0.057496</td>
    </tr>
    <tr>
      <th>2007-01-01 00:40:00</th>
      <td>-0.035206</td>
      <td>-0.419520</td>
      <td>0.526995</td>
      <td>-0.984191</td>
      <td>-0.887252</td>
      <td>1.115112</td>
      <td>-0.712150</td>
      <td>0.495760</td>
      <td>0.353897</td>
      <td>-0.038622</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-04-28 23:10:00</th>
      <td>-0.285537</td>
      <td>0.308361</td>
      <td>0.090108</td>
      <td>-1.349080</td>
      <td>-0.484834</td>
      <td>-0.455766</td>
      <td>-0.909964</td>
      <td>-0.050158</td>
      <td>-0.542478</td>
      <td>-0.147478</td>
    </tr>
    <tr>
      <th>2021-04-28 23:20:00</th>
      <td>-0.285537</td>
      <td>0.308361</td>
      <td>0.090108</td>
      <td>-1.349080</td>
      <td>-0.484834</td>
      <td>-0.455766</td>
      <td>-0.909964</td>
      <td>-0.050158</td>
      <td>-0.542478</td>
      <td>-0.147478</td>
    </tr>
    <tr>
      <th>2021-04-28 23:30:00</th>
      <td>-0.285538</td>
      <td>0.308361</td>
      <td>0.090108</td>
      <td>-1.349080</td>
      <td>-0.484834</td>
      <td>-0.455766</td>
      <td>-0.909964</td>
      <td>-0.050158</td>
      <td>-0.542478</td>
      <td>-0.147478</td>
    </tr>
    <tr>
      <th>2021-04-28 23:40:00</th>
      <td>-0.285538</td>
      <td>0.308361</td>
      <td>0.090108</td>
      <td>-1.349080</td>
      <td>-0.484834</td>
      <td>-0.455766</td>
      <td>-0.909964</td>
      <td>-0.050158</td>
      <td>-0.542478</td>
      <td>-0.147478</td>
    </tr>
    <tr>
      <th>2021-04-28 23:50:00</th>
      <td>-0.285538</td>
      <td>0.308360</td>
      <td>0.090107</td>
      <td>-1.349080</td>
      <td>-0.484834</td>
      <td>-0.455766</td>
      <td>-0.909964</td>
      <td>-0.050158</td>
      <td>-0.542478</td>
      <td>-0.147478</td>
    </tr>
  </tbody>
</table>
<p>736389 rows × 10 columns</p>
</div></div></div>
</div>
<p>We derive the true label for each point in time, by comparing it to the list. 1 indicates that there is an ICME occurring at the moment, 0 indicates that there isn’t.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">preprocess</span>

<span class="n">truelabelw</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">get_truelabel</span><span class="p">(</span><span class="n">wind_scaled</span><span class="p">,</span> <span class="n">evtListw</span><span class="p">))</span>
<span class="n">truelabela</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">get_truelabel</span><span class="p">(</span><span class="n">sta_scaled</span><span class="p">,</span> <span class="n">evtLista</span><span class="p">))</span>
<span class="n">truelabelb</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">get_truelabel</span><span class="p">(</span><span class="n">stb_scaled</span><span class="p">,</span> <span class="n">evtListb</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="splitting-the-data-into-training-validation-and-testing-set">
<h2><span class="section-number">3.3. </span>Splitting the data into training, validation, and testing set<a class="headerlink" href="#splitting-the-data-into-training-validation-and-testing-set" title="Permalink to this headline">¶</a></h2>
<p>When we compare the number of events per year included in our catalogs, we can see variation due to the solar cycle. Therefore, randomly splitting the data into training, validation and testing will propably lead to a severe imbalance. Thus, we manually split into subsets to create different splits of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">preprocess</span>

<span class="n">dicoflists</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;WIND&#39;</span><span class="p">:</span> <span class="n">evtListw</span><span class="p">,</span> <span class="s1">&#39;STEREOA&#39;</span><span class="p">:</span><span class="n">evtLista</span><span class="p">,</span> <span class="s1">&#39;STEREOB&#39;</span><span class="p">:</span><span class="n">evtListb</span><span class="p">}</span>
<span class="n">preprocess</span><span class="o">.</span><span class="n">compare_lists</span><span class="p">(</span><span class="n">dicoflists</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     WIND STEREOA STEREOB
2007    7       3       4
2008    5       5       8
2009   15       9      13
2010   15      13      16
2011   22      32      28
2012   30      36      33
2013   21      40      29
2014   15      29      17
2015   14       1       0
2016    9       6       0
2017   10      11       0
2018    8       5       0
2019    6      13       0
2020    8       2       0
2021    0       0       0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../../_images/MachineLearningPipeline_18_2.png" src="../../../_images/MachineLearningPipeline_18_2.png" />
</div>
</div>
<p>We have four different balanced splits to choose from. This gives us approximately the same number of events in each split. The function printpercentage shows us how much of the data is labeled positively. This percentage should be approximately equal over testing, validation and training.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">testw</span><span class="p">,</span> <span class="n">valw</span><span class="p">,</span> <span class="n">trainw</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getbalancedsplit</span><span class="p">(</span><span class="n">split</span><span class="p">,</span> <span class="s1">&#39;wind&#39;</span><span class="p">)</span> 
<span class="n">testa</span><span class="p">,</span> <span class="n">vala</span><span class="p">,</span> <span class="n">traina</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getbalancedsplit</span><span class="p">(</span><span class="n">split</span><span class="p">,</span> <span class="s1">&#39;stereoa&#39;</span><span class="p">)</span> 
<span class="n">testb</span><span class="p">,</span> <span class="n">valb</span><span class="p">,</span> <span class="n">trainb</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getbalancedsplit</span><span class="p">(</span><span class="n">split</span><span class="p">,</span> <span class="s1">&#39;stereob&#39;</span><span class="p">)</span> 

<span class="n">X_testw</span><span class="p">,</span> <span class="n">Y_testw</span><span class="p">,</span> <span class="n">X_valw</span><span class="p">,</span> <span class="n">Y_valw</span><span class="p">,</span> <span class="n">X_trainw</span><span class="p">,</span> <span class="n">Y_trainw</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getdatas</span><span class="p">(</span><span class="n">trainw</span><span class="p">,</span><span class="n">testw</span><span class="p">,</span><span class="n">valw</span><span class="p">,</span><span class="n">wind_scaled</span><span class="p">,</span><span class="n">truelabelw</span><span class="p">)</span>
<span class="n">X_testa</span><span class="p">,</span> <span class="n">Y_testa</span><span class="p">,</span> <span class="n">X_vala</span><span class="p">,</span> <span class="n">Y_vala</span><span class="p">,</span> <span class="n">X_traina</span><span class="p">,</span> <span class="n">Y_traina</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getdatas</span><span class="p">(</span><span class="n">traina</span><span class="p">,</span><span class="n">testa</span><span class="p">,</span><span class="n">vala</span><span class="p">,</span><span class="n">sta_scaled</span><span class="p">,</span><span class="n">truelabela</span><span class="p">)</span>
<span class="n">X_testb</span><span class="p">,</span> <span class="n">Y_testb</span><span class="p">,</span> <span class="n">X_valb</span><span class="p">,</span> <span class="n">Y_valb</span><span class="p">,</span> <span class="n">X_trainb</span><span class="p">,</span> <span class="n">Y_trainb</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">getdatas</span><span class="p">(</span><span class="n">trainb</span><span class="p">,</span><span class="n">testb</span><span class="p">,</span><span class="n">valb</span><span class="p">,</span><span class="n">stb_scaled</span><span class="p">,</span><span class="n">truelabelb</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">printpercentage</span><span class="p">(</span><span class="n">Y_testw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">printpercentage</span><span class="p">(</span><span class="n">Y_trainw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">printpercentage</span><span class="p">(</span><span class="n">Y_valw</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>label    0.052638
dtype: float64
label    0.046366
dtype: float64
label    0.043376
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>To train the model on all datasets at once, we need to join them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_trainw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_traina</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_trainb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">Y_train</span> <span class="o">=</span> <span class="n">Y_trainw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_traina</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">Y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_trainb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">####</span>

<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_valw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_vala</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">X_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_valb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">Y_val</span> <span class="o">=</span> <span class="n">Y_valw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_vala</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Y_val</span> <span class="o">=</span> <span class="n">Y_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_valb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">####</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_testw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_testa</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_testb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">Y_test</span> <span class="o">=</span> <span class="n">Y_testw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_testa</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">Y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_testb</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="resunet">
<h2><span class="section-number">3.4. </span>ResUNet++<a class="headerlink" href="#resunet" title="Permalink to this headline">¶</a></h2>
<p>By now, we set up everything that we need for a machine learning pipeline. We preprocessed the data in a way, that is understandable for our algorithm. Additionally, we translated our desired output to a label, that fits the type of architecture we want. The area of computer vision is a very well researched field in machine learning. One specific subclass is semantic segmentation, used for example in medial image segmentation. A recent advance is the so called <a class="reference external" href="https://arxiv.org/pdf/1911.07067.pdf">ResUNet++</a>, used for polyp detection. Even though we deal with a different problem here, namely timeseries instead of images, some characteristics of the use cases are similar:</p>
<p>We need information of WHAT and WHERE! Therefore we choose an architecture, that resembles the <a class="reference external" href="https://arxiv.org/pdf/1911.07067.pdf">ResUNet++</a>.</p>
<div class="section" id="u-net">
<h3><span class="section-number">3.4.1. </span>U-Net<a class="headerlink" href="#u-net" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Consists of Downsampling, Upsampling and Concatenation</p></li>
<li><p>Downsampling helps understand WHAT is the important information</p></li>
<li><p>Upsampling and Concatenation keeps information of WHERE</p></li>
</ul>
</div>
<div class="section" id="residual-units">
<h3><span class="section-number">3.4.2. </span>Residual Units<a class="headerlink" href="#residual-units" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Deeper = Better?</p></li>
<li><p>vanishing/exploding gradient problem hinders optimization for deep CNNs</p></li>
<li><p>shortcuts allow deeper networks while also reducing the computational cost</p></li>
</ul>
</div>
<div class="section" id="squeeze-and-excitation-units">
<h3><span class="section-number">3.4.3. </span>Squeeze and Excitation Units<a class="headerlink" href="#squeeze-and-excitation-units" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>improves channel interdependencies at almost no computational cost</p></li>
<li><p>content aware mechanism to weight each channel adaptively</p></li>
</ul>
</div>
<div class="section" id="atrous-spatial-pyramidal-pooling">
<h3><span class="section-number">3.4.4. </span>Atrous Spatial Pyramidal Pooling<a class="headerlink" href="#atrous-spatial-pyramidal-pooling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>module for resampling a given feature layer at multiple rates prior to convolution</p></li>
</ul>
</div>
<div class="section" id="attention-units">
<h3><span class="section-number">3.4.5. </span>Attention Units<a class="headerlink" href="#attention-units" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>boosts performance and reduces computational cost</p></li>
<li><p>determines which parts of the network require more attention</p></li>
</ul>
<p><img alt="Blockdiagram of our architecture" src="../../../_images/blockdiagram.jpg" /></p>
<p>The next step is the setup of some parameters and the generators for training and validation. The Generator is based on the tensorflow sequence class, but generates windows in time of a specific size and their corresponding onedimensional “segmentation maps”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metrics</span> <span class="kn">import</span> <span class="n">dice_coef</span><span class="p">,</span> <span class="n">dice_loss</span><span class="p">,</span> <span class="n">true_skill_score</span>
<span class="kn">from</span> <span class="nn">unetgen</span> <span class="kn">import</span> <span class="n">UnetGen</span>
<span class="kn">from</span> <span class="nn">cycliclr</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="s2">&quot;model&quot;</span>

<span class="c1">## Parameters</span>

<span class="n">C</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># number of channels</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c1"># window size</span>
<span class="n">image_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">epochs</span> <span class="o">=</span><span class="mi">500</span>
<span class="n">expclr</span> <span class="o">=</span> <span class="n">CyclicLR</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1">## Generator</span>
<span class="n">train_gen</span> <span class="o">=</span> <span class="n">UnetGen</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
<span class="n">valid_gen</span> <span class="o">=</span> <span class="n">UnetGen</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we build the model and initiate some callbacks. We also select suitable metrics and start the training process:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">model</span> <span class="kn">import</span> <span class="n">ResUnetPlusPlus</span>

<span class="c1">#### ResUnet++</span>

<span class="n">arch</span> <span class="o">=</span> <span class="n">ResUnetPlusPlus</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="n">image_size</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">arch</span><span class="o">.</span><span class="n">build_model</span><span class="p">()</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">()</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">Recall</span><span class="p">(),</span> <span class="n">Precision</span><span class="p">(),</span> <span class="n">dice_coef</span><span class="p">,</span><span class="n">true_skill_score</span><span class="p">,</span> <span class="n">MeanIoU</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">dice_loss</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span> 

<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">early_stopping</span><span class="p">,</span><span class="n">expclr</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-12-05 23:44:52.346542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 15405 MB memory:  -&gt; device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:09:00.0, compute capability: 6.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_gen</span><span class="p">,</span>
          <span class="n">validation_data</span><span class="o">=</span><span class="n">valid_gen</span><span class="p">,</span>
          <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
          <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-12-05 20:16:30.846649: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/500
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-12-05 20:16:35.886758: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>219/219 [==============================] - 130s 547ms/step - loss: 0.6775 - recall: 0.6023 - precision: 0.2377 - dice_coef: 0.3224 - true_skill_score: 0.6404 - mean_io_u: 0.5976 - val_loss: 0.7395 - val_recall: 0.4349 - val_precision: 0.5814 - val_dice_coef: 0.2604 - val_true_skill_score: 0.5735 - val_mean_io_u: 0.6313

Epoch 00001: val_loss improved from inf to 0.73945, saving model to model
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-12-05 20:18:46.940977: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:tensorflow:Assets written to: model/assets
Epoch 2/500
219/219 [==============================] - 113s 515ms/step - loss: 0.6057 - recall: 0.5582 - precision: 0.4073 - dice_coef: 0.3943 - true_skill_score: 0.7000 - mean_io_u: 0.6238 - val_loss: 0.7049 - val_recall: 0.6780 - val_precision: 0.3404 - val_dice_coef: 0.2965 - val_true_skill_score: 0.6990 - val_mean_io_u: 0.6196

Epoch 00002: val_loss improved from 0.73945 to 0.70488, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 3/500
219/219 [==============================] - 113s 515ms/step - loss: 0.6073 - recall: 0.5296 - precision: 0.4191 - dice_coef: 0.3927 - true_skill_score: 0.6808 - mean_io_u: 0.6240 - val_loss: 0.7181 - val_recall: 0.8018 - val_precision: 0.2674 - val_dice_coef: 0.2835 - val_true_skill_score: 0.7271 - val_mean_io_u: 0.5782

Epoch 00003: val_loss did not improve from 0.70488
Epoch 4/500
219/219 [==============================] - 113s 515ms/step - loss: 0.6136 - recall: 0.5354 - precision: 0.4217 - dice_coef: 0.3862 - true_skill_score: 0.6894 - mean_io_u: 0.6219 - val_loss: 0.6550 - val_recall: 0.6404 - val_precision: 0.4120 - val_dice_coef: 0.3456 - val_true_skill_score: 0.6853 - val_mean_io_u: 0.6457

Epoch 00004: val_loss improved from 0.70488 to 0.65499, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 5/500
219/219 [==============================] - 113s 515ms/step - loss: 0.6059 - recall: 0.5338 - precision: 0.4202 - dice_coef: 0.3941 - true_skill_score: 0.6970 - mean_io_u: 0.6236 - val_loss: 0.6732 - val_recall: 0.7427 - val_precision: 0.3162 - val_dice_coef: 0.3279 - val_true_skill_score: 0.7060 - val_mean_io_u: 0.6165

Epoch 00005: val_loss did not improve from 0.65499
Epoch 6/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5881 - recall: 0.5409 - precision: 0.4547 - dice_coef: 0.4117 - true_skill_score: 0.6997 - mean_io_u: 0.6346 - val_loss: 0.5220 - val_recall: 0.5578 - val_precision: 0.5810 - val_dice_coef: 0.4769 - val_true_skill_score: 0.6609 - val_mean_io_u: 0.6753

Epoch 00006: val_loss improved from 0.65499 to 0.52200, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 7/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5664 - recall: 0.5559 - precision: 0.4877 - dice_coef: 0.4336 - true_skill_score: 0.7130 - mean_io_u: 0.6470 - val_loss: 0.5341 - val_recall: 0.5464 - val_precision: 0.5776 - val_dice_coef: 0.4649 - val_true_skill_score: 0.6487 - val_mean_io_u: 0.6720

Epoch 00007: val_loss did not improve from 0.52200
Epoch 8/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5449 - recall: 0.5748 - precision: 0.5329 - dice_coef: 0.4551 - true_skill_score: 0.7243 - mean_io_u: 0.6653 - val_loss: 0.5153 - val_recall: 0.3877 - val_precision: 0.7236 - val_dice_coef: 0.4836 - val_true_skill_score: 0.5543 - val_mean_io_u: 0.6290

Epoch 00008: val_loss improved from 0.52200 to 0.51528, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 9/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5308 - recall: 0.5938 - precision: 0.5591 - dice_coef: 0.4693 - true_skill_score: 0.7347 - mean_io_u: 0.6751 - val_loss: 0.5068 - val_recall: 0.4082 - val_precision: 0.7385 - val_dice_coef: 0.4920 - val_true_skill_score: 0.5742 - val_mean_io_u: 0.6397

Epoch 00009: val_loss improved from 0.51528 to 0.50679, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 10/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5184 - recall: 0.6029 - precision: 0.5776 - dice_coef: 0.4817 - true_skill_score: 0.7445 - mean_io_u: 0.6844 - val_loss: 0.4838 - val_recall: 0.4651 - val_precision: 0.6898 - val_dice_coef: 0.5150 - val_true_skill_score: 0.5990 - val_mean_io_u: 0.6548

Epoch 00010: val_loss improved from 0.50679 to 0.48379, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 11/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5277 - recall: 0.6042 - precision: 0.5577 - dice_coef: 0.4723 - true_skill_score: 0.7390 - mean_io_u: 0.6787 - val_loss: 0.4609 - val_recall: 0.4558 - val_precision: 0.6819 - val_dice_coef: 0.5377 - val_true_skill_score: 0.5923 - val_mean_io_u: 0.6599

Epoch 00011: val_loss improved from 0.48379 to 0.46095, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 12/500
219/219 [==============================] - 113s 516ms/step - loss: 0.5466 - recall: 0.5644 - precision: 0.5390 - dice_coef: 0.4535 - true_skill_score: 0.7229 - mean_io_u: 0.6632 - val_loss: 0.5608 - val_recall: 0.5486 - val_precision: 0.5828 - val_dice_coef: 0.4388 - val_true_skill_score: 0.6573 - val_mean_io_u: 0.6759

Epoch 00012: val_loss did not improve from 0.46095
Epoch 13/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5555 - recall: 0.5874 - precision: 0.5148 - dice_coef: 0.4445 - true_skill_score: 0.7261 - mean_io_u: 0.6626 - val_loss: 0.5019 - val_recall: 0.5980 - val_precision: 0.5438 - val_dice_coef: 0.4976 - val_true_skill_score: 0.6721 - val_mean_io_u: 0.6806

Epoch 00013: val_loss did not improve from 0.46095
Epoch 14/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5655 - recall: 0.5757 - precision: 0.4796 - dice_coef: 0.4343 - true_skill_score: 0.7192 - mean_io_u: 0.6503 - val_loss: 0.5674 - val_recall: 0.6625 - val_precision: 0.3984 - val_dice_coef: 0.4326 - val_true_skill_score: 0.6855 - val_mean_io_u: 0.6398

Epoch 00014: val_loss did not improve from 0.46095
Epoch 15/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5579 - recall: 0.5799 - precision: 0.4924 - dice_coef: 0.4419 - true_skill_score: 0.7292 - mean_io_u: 0.6538 - val_loss: 0.4984 - val_recall: 0.4556 - val_precision: 0.6668 - val_dice_coef: 0.5004 - val_true_skill_score: 0.5950 - val_mean_io_u: 0.6588

Epoch 00015: val_loss did not improve from 0.46095
Epoch 16/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5365 - recall: 0.5980 - precision: 0.5194 - dice_coef: 0.4635 - true_skill_score: 0.7368 - mean_io_u: 0.6665 - val_loss: 0.5106 - val_recall: 0.4966 - val_precision: 0.6163 - val_dice_coef: 0.4883 - val_true_skill_score: 0.6274 - val_mean_io_u: 0.6652

Epoch 00016: val_loss did not improve from 0.46095
Epoch 17/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5178 - recall: 0.6201 - precision: 0.5626 - dice_coef: 0.4821 - true_skill_score: 0.7504 - mean_io_u: 0.6836 - val_loss: 0.4551 - val_recall: 0.4459 - val_precision: 0.7228 - val_dice_coef: 0.5435 - val_true_skill_score: 0.5926 - val_mean_io_u: 0.6570

Epoch 00017: val_loss improved from 0.46095 to 0.45511, saving model to model
INFO:tensorflow:Assets written to: model/assets
Epoch 18/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5027 - recall: 0.6379 - precision: 0.5927 - dice_coef: 0.4973 - true_skill_score: 0.7530 - mean_io_u: 0.6972 - val_loss: 0.5153 - val_recall: 0.4717 - val_precision: 0.6780 - val_dice_coef: 0.4837 - val_true_skill_score: 0.6132 - val_mean_io_u: 0.6568

Epoch 00018: val_loss did not improve from 0.45511
Epoch 19/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4893 - recall: 0.6617 - precision: 0.5991 - dice_coef: 0.5107 - true_skill_score: 0.7716 - mean_io_u: 0.7075 - val_loss: 0.5073 - val_recall: 0.4543 - val_precision: 0.6875 - val_dice_coef: 0.4916 - val_true_skill_score: 0.6043 - val_mean_io_u: 0.6548

Epoch 00019: val_loss did not improve from 0.45511
Epoch 20/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4934 - recall: 0.6508 - precision: 0.6018 - dice_coef: 0.5066 - true_skill_score: 0.7629 - mean_io_u: 0.7037 - val_loss: 0.5570 - val_recall: 0.4194 - val_precision: 0.6691 - val_dice_coef: 0.4421 - val_true_skill_score: 0.5829 - val_mean_io_u: 0.6465

Epoch 00020: val_loss did not improve from 0.45511
Epoch 21/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5122 - recall: 0.6448 - precision: 0.5744 - dice_coef: 0.4878 - true_skill_score: 0.7477 - mean_io_u: 0.6936 - val_loss: 0.5110 - val_recall: 0.4910 - val_precision: 0.6056 - val_dice_coef: 0.4881 - val_true_skill_score: 0.6054 - val_mean_io_u: 0.6583
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 00021: val_loss did not improve from 0.45511
Epoch 22/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5233 - recall: 0.6048 - precision: 0.5554 - dice_coef: 0.4767 - true_skill_score: 0.7422 - mean_io_u: 0.6791 - val_loss: 0.5684 - val_recall: 0.5652 - val_precision: 0.5347 - val_dice_coef: 0.4318 - val_true_skill_score: 0.6585 - val_mean_io_u: 0.6683

Epoch 00022: val_loss did not improve from 0.45511
Epoch 23/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5954 - recall: 0.5149 - precision: 0.4576 - dice_coef: 0.4047 - true_skill_score: 0.6747 - mean_io_u: 0.6319 - val_loss: 0.7225 - val_recall: 0.6667 - val_precision: 0.3095 - val_dice_coef: 0.2777 - val_true_skill_score: 0.6603 - val_mean_io_u: 0.6110

Epoch 00023: val_loss did not improve from 0.45511
Epoch 24/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5702 - recall: 0.5628 - precision: 0.4956 - dice_coef: 0.4298 - true_skill_score: 0.7211 - mean_io_u: 0.6492 - val_loss: 0.5763 - val_recall: 0.5461 - val_precision: 0.5568 - val_dice_coef: 0.4229 - val_true_skill_score: 0.6465 - val_mean_io_u: 0.6667

Epoch 00024: val_loss did not improve from 0.45511
Epoch 25/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5337 - recall: 0.5873 - precision: 0.5664 - dice_coef: 0.4664 - true_skill_score: 0.7315 - mean_io_u: 0.6748 - val_loss: 0.4622 - val_recall: 0.4206 - val_precision: 0.7112 - val_dice_coef: 0.5364 - val_true_skill_score: 0.5655 - val_mean_io_u: 0.6462

Epoch 00025: val_loss did not improve from 0.45511
Epoch 26/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5195 - recall: 0.5810 - precision: 0.5736 - dice_coef: 0.4806 - true_skill_score: 0.7317 - mean_io_u: 0.6745 - val_loss: 0.4703 - val_recall: 0.3423 - val_precision: 0.8260 - val_dice_coef: 0.5284 - val_true_skill_score: 0.5254 - val_mean_io_u: 0.6143

Epoch 00026: val_loss did not improve from 0.45511
Epoch 27/500
219/219 [==============================] - 113s 515ms/step - loss: 0.5009 - recall: 0.6284 - precision: 0.5978 - dice_coef: 0.4991 - true_skill_score: 0.7561 - mean_io_u: 0.6961 - val_loss: 0.5101 - val_recall: 0.4939 - val_precision: 0.6713 - val_dice_coef: 0.4894 - val_true_skill_score: 0.6196 - val_mean_io_u: 0.6682

Epoch 00027: val_loss did not improve from 0.45511
Epoch 28/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4844 - recall: 0.6553 - precision: 0.6071 - dice_coef: 0.5156 - true_skill_score: 0.7721 - mean_io_u: 0.7063 - val_loss: 0.4994 - val_recall: 0.4991 - val_precision: 0.6767 - val_dice_coef: 0.5002 - val_true_skill_score: 0.6175 - val_mean_io_u: 0.6713

Epoch 00028: val_loss did not improve from 0.45511
Epoch 29/500
219/219 [==============================] - 113s 515ms/step - loss: 0.4961 - recall: 0.6655 - precision: 0.5657 - dice_coef: 0.5039 - true_skill_score: 0.7702 - mean_io_u: 0.6978 - val_loss: 0.4998 - val_recall: 0.3970 - val_precision: 0.7453 - val_dice_coef: 0.4992 - val_true_skill_score: 0.5634 - val_mean_io_u: 0.6303

Epoch 00029: val_loss did not improve from 0.45511
Epoch 30/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4987 - recall: 0.6472 - precision: 0.5812 - dice_coef: 0.5013 - true_skill_score: 0.7560 - mean_io_u: 0.6927 - val_loss: 0.5522 - val_recall: 0.5010 - val_precision: 0.6347 - val_dice_coef: 0.4479 - val_true_skill_score: 0.6196 - val_mean_io_u: 0.6677

Epoch 00030: val_loss did not improve from 0.45511
Epoch 31/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5162 - recall: 0.6342 - precision: 0.5320 - dice_coef: 0.4838 - true_skill_score: 0.7464 - mean_io_u: 0.6769 - val_loss: 0.6465 - val_recall: 0.5490 - val_precision: 0.5060 - val_dice_coef: 0.3541 - val_true_skill_score: 0.6417 - val_mean_io_u: 0.6565

Epoch 00031: val_loss did not improve from 0.45511
Epoch 32/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5224 - recall: 0.6156 - precision: 0.5322 - dice_coef: 0.4776 - true_skill_score: 0.7459 - mean_io_u: 0.6728 - val_loss: 0.5431 - val_recall: 0.4973 - val_precision: 0.6007 - val_dice_coef: 0.4570 - val_true_skill_score: 0.6153 - val_mean_io_u: 0.6624

Epoch 00032: val_loss did not improve from 0.45511
Epoch 33/500
219/219 [==============================] - 113s 514ms/step - loss: 0.5046 - recall: 0.6549 - precision: 0.5772 - dice_coef: 0.4955 - true_skill_score: 0.7630 - mean_io_u: 0.6946 - val_loss: 0.5717 - val_recall: 0.5058 - val_precision: 0.6136 - val_dice_coef: 0.4276 - val_true_skill_score: 0.6201 - val_mean_io_u: 0.6630

Epoch 00033: val_loss did not improve from 0.45511
Epoch 34/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4824 - recall: 0.6971 - precision: 0.5820 - dice_coef: 0.5176 - true_skill_score: 0.7885 - mean_io_u: 0.7122 - val_loss: 0.4688 - val_recall: 0.4237 - val_precision: 0.7052 - val_dice_coef: 0.5300 - val_true_skill_score: 0.5648 - val_mean_io_u: 0.6483

Epoch 00034: val_loss did not improve from 0.45511
Epoch 35/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4749 - recall: 0.6976 - precision: 0.6228 - dice_coef: 0.5252 - true_skill_score: 0.7879 - mean_io_u: 0.7234 - val_loss: 0.5650 - val_recall: 0.5073 - val_precision: 0.6727 - val_dice_coef: 0.4345 - val_true_skill_score: 0.6205 - val_mean_io_u: 0.6677

Epoch 00035: val_loss did not improve from 0.45511
Epoch 36/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4614 - recall: 0.7143 - precision: 0.6361 - dice_coef: 0.5386 - true_skill_score: 0.8045 - mean_io_u: 0.7328 - val_loss: 0.5654 - val_recall: 0.4905 - val_precision: 0.6553 - val_dice_coef: 0.4341 - val_true_skill_score: 0.6081 - val_mean_io_u: 0.6619

Epoch 00036: val_loss did not improve from 0.45511
Epoch 37/500
219/219 [==============================] - 113s 514ms/step - loss: 0.4538 - recall: 0.7334 - precision: 0.6364 - dice_coef: 0.5463 - true_skill_score: 0.8159 - mean_io_u: 0.7400 - val_loss: 0.5604 - val_recall: 0.5036 - val_precision: 0.6424 - val_dice_coef: 0.4392 - val_true_skill_score: 0.6153 - val_mean_io_u: 0.6684

Epoch 00037: val_loss did not improve from 0.45511
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;keras.callbacks.History at 0x7fdf660d07c0&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluation">
<h2><span class="section-number">3.5. </span>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">¶</a></h2>
<p>After the training process is finished, we continue by testing our model on unseen data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">postprocess</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>


<span class="c1">## Model</span>
<span class="k">with</span> <span class="n">CustomObjectScope</span><span class="p">({</span><span class="s1">&#39;dice_loss&#39;</span><span class="p">:</span> <span class="n">dice_loss</span><span class="p">,</span> <span class="s1">&#39;dice_coef&#39;</span><span class="p">:</span> <span class="n">dice_coef</span><span class="p">,</span> <span class="s1">&#39;true_skill_score&#39;</span><span class="p">:</span> <span class="n">true_skill_score</span><span class="p">}):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="c1"># TEST WIND</span>

<span class="n">test_genw</span> <span class="o">=</span> <span class="n">UnetGen</span><span class="p">(</span><span class="n">X_testw</span><span class="p">,</span> <span class="n">Y_testw</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_genw</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">resultw</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">generate_result</span><span class="p">(</span><span class="n">X_testw</span><span class="p">,</span> <span class="n">Y_testw</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># TEST STEREO A</span>

<span class="n">test_gena</span> <span class="o">=</span> <span class="n">UnetGen</span><span class="p">(</span><span class="n">X_testa</span><span class="p">,</span> <span class="n">Y_testa</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_gena</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">resulta</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">generate_result</span><span class="p">(</span><span class="n">X_testa</span><span class="p">,</span> <span class="n">Y_testa</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># TEST STEREO B</span>

<span class="n">test_genb</span> <span class="o">=</span> <span class="n">UnetGen</span><span class="p">(</span><span class="n">X_testb</span><span class="p">,</span> <span class="n">Y_testb</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_genb</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">resultb</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">generate_result</span><span class="p">(</span><span class="n">X_testb</span><span class="p">,</span> <span class="n">Y_testb</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-12-05 23:44:59.467293: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2021-12-05 23:45:01.187044: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>151/151 [==============================] - 6s 24ms/step - loss: 0.1881 - recall: 0.6126 - precision: 0.6893 - dice_coef: 0.8119 - true_skill_score: 0.8451 - mean_io_u: 0.7166
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 151/151 [00:12&lt;00:00, 11.96it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>108/108 [==============================] - 3s 24ms/step - loss: 0.2628 - recall: 0.4913 - precision: 0.7317 - dice_coef: 0.7372 - true_skill_score: 0.7299 - mean_io_u: 0.6717
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 108/108 [00:08&lt;00:00, 12.25it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90/90 [==============================] - 2s 23ms/step - loss: 0.2455 - recall: 0.4734 - precision: 0.7061 - dice_coef: 0.7545 - true_skill_score: 0.7714 - mean_io_u: 0.6590
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████| 90/90 [00:07&lt;00:00, 12.49it/s]
</pre></div>
</div>
</div>
</div>
<p>We use the following metrics to evaluate our model:</p>
<div class="section" id="precision">
<h3><span class="section-number">3.5.1. </span>Precision<a class="headerlink" href="#precision" title="Permalink to this headline">¶</a></h3>
<p>percentage of true ICMEs predicted by the algorithm out of all predicted</p>
<ul class="simple">
<li><p>True Positives/(True Positives + False Positives)</p></li>
</ul>
</div>
<div class="section" id="recall">
<h3><span class="section-number">3.5.2. </span>Recall<a class="headerlink" href="#recall" title="Permalink to this headline">¶</a></h3>
<p>percentage of true ICMEs predicted by the algorithm out of all true</p>
<ul class="simple">
<li><p>True Positives/(True Positives + False Negatives)</p></li>
</ul>
</div>
<div class="section" id="mean-iou">
<h3><span class="section-number">3.5.3. </span>Mean IoU<a class="headerlink" href="#mean-iou" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>True Positives/(True Positives + False Negatives + False Positives)</p></li>
</ul>
</div>
<div class="section" id="dice-coefficient">
<h3><span class="section-number">3.5.4. </span>Dice Coefficient<a class="headerlink" href="#dice-coefficient" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>2 x Intersection/Union</p></li>
</ul>
</div>
<div class="section" id="true-skill-score">
<h3><span class="section-number">3.5.5. </span>True Skill Score<a class="headerlink" href="#true-skill-score" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>True Positives/(True Positives + False Negatives) - False Positives/(False Positives + True Negatives)</p></li>
</ul>
<p>To get a better feeling for the performance in terms of detection rate, we first need to convert our onedimensional segmentation map to a list of events:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluate WIND</span>

<span class="n">resultw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">resultw</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">resultbinw</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">make_binary</span><span class="p">(</span><span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">eventsw</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">makeEventList</span><span class="p">(</span><span class="n">resultbinw</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ICMEsw</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">removeCreepy</span><span class="p">(</span><span class="n">eventsw</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">test_cloudsw</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evtListw</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">begin</span><span class="o">.</span><span class="n">year</span> <span class="ow">in</span> <span class="n">testw</span><span class="p">)]</span>

<span class="c1"># evaluate STEREO A</span>

<span class="n">resulta</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">resulta</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">resultbina</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">make_binary</span><span class="p">(</span><span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">eventsa</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">makeEventList</span><span class="p">(</span><span class="n">resultbina</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ICMEsa</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">removeCreepy</span><span class="p">(</span><span class="n">eventsa</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">test_cloudsa</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evtLista</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">begin</span><span class="o">.</span><span class="n">year</span> <span class="ow">in</span> <span class="n">testa</span><span class="p">)]</span>

<span class="c1"># evaluate STEREO B</span>

<span class="n">resultb</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pds</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">resultb</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">resultbinb</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">make_binary</span><span class="p">(</span><span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">eventsb</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">makeEventList</span><span class="p">(</span><span class="n">resultbinb</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ICMEsb</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">removeCreepy</span><span class="p">(</span><span class="n">eventsb</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">test_cloudsb</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evtListb</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">begin</span><span class="o">.</span><span class="n">year</span> <span class="ow">in</span> <span class="n">testb</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>We can then plot the events and their associated similarity values to compare true label to predicted label.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot events and associated similarity values</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_cloudsw</span><span class="p">)):</span>
    <span class="n">test_cloudsw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot_similaritymap</span><span class="p">(</span><span class="n">datawin</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;WIND &#39;</span><span class="p">,</span><span class="n">resultw</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_cloudsa</span><span class="p">)):</span>
    <span class="n">test_cloudsa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot_similaritymap</span><span class="p">(</span><span class="n">dataa</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;STEREO A &#39;</span><span class="p">,</span><span class="n">resulta</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_cloudsb</span><span class="p">)):</span>
    <span class="n">test_cloudsb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot_similaritymap</span><span class="p">(</span><span class="n">datab</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;STEREO B &#39;</span><span class="p">,</span><span class="n">resultb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/MachineLearningPipeline_36_0.png" src="../../../_images/MachineLearningPipeline_36_0.png" />
<img alt="../../../_images/MachineLearningPipeline_36_1.png" src="../../../_images/MachineLearningPipeline_36_1.png" />
<img alt="../../../_images/MachineLearningPipeline_36_2.png" src="../../../_images/MachineLearningPipeline_36_2.png" />
<img alt="../../../_images/MachineLearningPipeline_36_3.png" src="../../../_images/MachineLearningPipeline_36_3.png" />
<img alt="../../../_images/MachineLearningPipeline_36_4.png" src="../../../_images/MachineLearningPipeline_36_4.png" />
<img alt="../../../_images/MachineLearningPipeline_36_5.png" src="../../../_images/MachineLearningPipeline_36_5.png" />
<img alt="../../../_images/MachineLearningPipeline_36_6.png" src="../../../_images/MachineLearningPipeline_36_6.png" />
<img alt="../../../_images/MachineLearningPipeline_36_7.png" src="../../../_images/MachineLearningPipeline_36_7.png" />
<img alt="../../../_images/MachineLearningPipeline_36_8.png" src="../../../_images/MachineLearningPipeline_36_8.png" />
<img alt="../../../_images/MachineLearningPipeline_36_9.png" src="../../../_images/MachineLearningPipeline_36_9.png" />
<img alt="../../../_images/MachineLearningPipeline_36_10.png" src="../../../_images/MachineLearningPipeline_36_10.png" />
<img alt="../../../_images/MachineLearningPipeline_36_11.png" src="../../../_images/MachineLearningPipeline_36_11.png" />
<img alt="../../../_images/MachineLearningPipeline_36_12.png" src="../../../_images/MachineLearningPipeline_36_12.png" />
<img alt="../../../_images/MachineLearningPipeline_36_13.png" src="../../../_images/MachineLearningPipeline_36_13.png" />
<img alt="../../../_images/MachineLearningPipeline_36_14.png" src="../../../_images/MachineLearningPipeline_36_14.png" />
<img alt="../../../_images/MachineLearningPipeline_36_15.png" src="../../../_images/MachineLearningPipeline_36_15.png" />
<img alt="../../../_images/MachineLearningPipeline_36_16.png" src="../../../_images/MachineLearningPipeline_36_16.png" />
<img alt="../../../_images/MachineLearningPipeline_36_17.png" src="../../../_images/MachineLearningPipeline_36_17.png" />
<img alt="../../../_images/MachineLearningPipeline_36_18.png" src="../../../_images/MachineLearningPipeline_36_18.png" />
<img alt="../../../_images/MachineLearningPipeline_36_19.png" src="../../../_images/MachineLearningPipeline_36_19.png" />
<img alt="../../../_images/MachineLearningPipeline_36_20.png" src="../../../_images/MachineLearningPipeline_36_20.png" />
<img alt="../../../_images/MachineLearningPipeline_36_21.png" src="../../../_images/MachineLearningPipeline_36_21.png" />
<img alt="../../../_images/MachineLearningPipeline_36_22.png" src="../../../_images/MachineLearningPipeline_36_22.png" />
<img alt="../../../_images/MachineLearningPipeline_36_23.png" src="../../../_images/MachineLearningPipeline_36_23.png" />
<img alt="../../../_images/MachineLearningPipeline_36_24.png" src="../../../_images/MachineLearningPipeline_36_24.png" />
<img alt="../../../_images/MachineLearningPipeline_36_25.png" src="../../../_images/MachineLearningPipeline_36_25.png" />
<img alt="../../../_images/MachineLearningPipeline_36_26.png" src="../../../_images/MachineLearningPipeline_36_26.png" />
<img alt="../../../_images/MachineLearningPipeline_36_27.png" src="../../../_images/MachineLearningPipeline_36_27.png" />
<img alt="../../../_images/MachineLearningPipeline_36_28.png" src="../../../_images/MachineLearningPipeline_36_28.png" />
<img alt="../../../_images/MachineLearningPipeline_36_29.png" src="../../../_images/MachineLearningPipeline_36_29.png" />
<img alt="../../../_images/MachineLearningPipeline_36_30.png" src="../../../_images/MachineLearningPipeline_36_30.png" />
<img alt="../../../_images/MachineLearningPipeline_36_31.png" src="../../../_images/MachineLearningPipeline_36_31.png" />
<img alt="../../../_images/MachineLearningPipeline_36_32.png" src="../../../_images/MachineLearningPipeline_36_32.png" />
<img alt="../../../_images/MachineLearningPipeline_36_33.png" src="../../../_images/MachineLearningPipeline_36_33.png" />
<img alt="../../../_images/MachineLearningPipeline_36_34.png" src="../../../_images/MachineLearningPipeline_36_34.png" />
<img alt="../../../_images/MachineLearningPipeline_36_35.png" src="../../../_images/MachineLearningPipeline_36_35.png" />
<img alt="../../../_images/MachineLearningPipeline_36_36.png" src="../../../_images/MachineLearningPipeline_36_36.png" />
<img alt="../../../_images/MachineLearningPipeline_36_37.png" src="../../../_images/MachineLearningPipeline_36_37.png" />
<img alt="../../../_images/MachineLearningPipeline_36_38.png" src="../../../_images/MachineLearningPipeline_36_38.png" />
<img alt="../../../_images/MachineLearningPipeline_36_39.png" src="../../../_images/MachineLearningPipeline_36_39.png" />
<img alt="../../../_images/MachineLearningPipeline_36_40.png" src="../../../_images/MachineLearningPipeline_36_40.png" />
<img alt="../../../_images/MachineLearningPipeline_36_41.png" src="../../../_images/MachineLearningPipeline_36_41.png" />
<img alt="../../../_images/MachineLearningPipeline_36_42.png" src="../../../_images/MachineLearningPipeline_36_42.png" />
<img alt="../../../_images/MachineLearningPipeline_36_43.png" src="../../../_images/MachineLearningPipeline_36_43.png" />
<img alt="../../../_images/MachineLearningPipeline_36_44.png" src="../../../_images/MachineLearningPipeline_36_44.png" />
<img alt="../../../_images/MachineLearningPipeline_36_45.png" src="../../../_images/MachineLearningPipeline_36_45.png" />
<img alt="../../../_images/MachineLearningPipeline_36_46.png" src="../../../_images/MachineLearningPipeline_36_46.png" />
<img alt="../../../_images/MachineLearningPipeline_36_47.png" src="../../../_images/MachineLearningPipeline_36_47.png" />
<img alt="../../../_images/MachineLearningPipeline_36_48.png" src="../../../_images/MachineLearningPipeline_36_48.png" />
<img alt="../../../_images/MachineLearningPipeline_36_49.png" src="../../../_images/MachineLearningPipeline_36_49.png" />
<img alt="../../../_images/MachineLearningPipeline_36_50.png" src="../../../_images/MachineLearningPipeline_36_50.png" />
<img alt="../../../_images/MachineLearningPipeline_36_51.png" src="../../../_images/MachineLearningPipeline_36_51.png" />
<img alt="../../../_images/MachineLearningPipeline_36_52.png" src="../../../_images/MachineLearningPipeline_36_52.png" />
<img alt="../../../_images/MachineLearningPipeline_36_53.png" src="../../../_images/MachineLearningPipeline_36_53.png" />
<img alt="../../../_images/MachineLearningPipeline_36_54.png" src="../../../_images/MachineLearningPipeline_36_54.png" />
<img alt="../../../_images/MachineLearningPipeline_36_55.png" src="../../../_images/MachineLearningPipeline_36_55.png" />
<img alt="../../../_images/MachineLearningPipeline_36_56.png" src="../../../_images/MachineLearningPipeline_36_56.png" />
<img alt="../../../_images/MachineLearningPipeline_36_57.png" src="../../../_images/MachineLearningPipeline_36_57.png" />
<img alt="../../../_images/MachineLearningPipeline_36_58.png" src="../../../_images/MachineLearningPipeline_36_58.png" />
<img alt="../../../_images/MachineLearningPipeline_36_59.png" src="../../../_images/MachineLearningPipeline_36_59.png" />
<img alt="../../../_images/MachineLearningPipeline_36_60.png" src="../../../_images/MachineLearningPipeline_36_60.png" />
<img alt="../../../_images/MachineLearningPipeline_36_61.png" src="../../../_images/MachineLearningPipeline_36_61.png" />
<img alt="../../../_images/MachineLearningPipeline_36_62.png" src="../../../_images/MachineLearningPipeline_36_62.png" />
<img alt="../../../_images/MachineLearningPipeline_36_63.png" src="../../../_images/MachineLearningPipeline_36_63.png" />
<img alt="../../../_images/MachineLearningPipeline_36_64.png" src="../../../_images/MachineLearningPipeline_36_64.png" />
<img alt="../../../_images/MachineLearningPipeline_36_65.png" src="../../../_images/MachineLearningPipeline_36_65.png" />
<img alt="../../../_images/MachineLearningPipeline_36_66.png" src="../../../_images/MachineLearningPipeline_36_66.png" />
<img alt="../../../_images/MachineLearningPipeline_36_67.png" src="../../../_images/MachineLearningPipeline_36_67.png" />
<img alt="../../../_images/MachineLearningPipeline_36_68.png" src="../../../_images/MachineLearningPipeline_36_68.png" />
<img alt="../../../_images/MachineLearningPipeline_36_69.png" src="../../../_images/MachineLearningPipeline_36_69.png" />
<img alt="../../../_images/MachineLearningPipeline_36_70.png" src="../../../_images/MachineLearningPipeline_36_70.png" />
<img alt="../../../_images/MachineLearningPipeline_36_71.png" src="../../../_images/MachineLearningPipeline_36_71.png" />
<img alt="../../../_images/MachineLearningPipeline_36_72.png" src="../../../_images/MachineLearningPipeline_36_72.png" />
<img alt="../../../_images/MachineLearningPipeline_36_73.png" src="../../../_images/MachineLearningPipeline_36_73.png" />
<img alt="../../../_images/MachineLearningPipeline_36_74.png" src="../../../_images/MachineLearningPipeline_36_74.png" />
<img alt="../../../_images/MachineLearningPipeline_36_75.png" src="../../../_images/MachineLearningPipeline_36_75.png" />
<img alt="../../../_images/MachineLearningPipeline_36_76.png" src="../../../_images/MachineLearningPipeline_36_76.png" />
<img alt="../../../_images/MachineLearningPipeline_36_77.png" src="../../../_images/MachineLearningPipeline_36_77.png" />
<img alt="../../../_images/MachineLearningPipeline_36_78.png" src="../../../_images/MachineLearningPipeline_36_78.png" />
<img alt="../../../_images/MachineLearningPipeline_36_79.png" src="../../../_images/MachineLearningPipeline_36_79.png" />
<img alt="../../../_images/MachineLearningPipeline_36_80.png" src="../../../_images/MachineLearningPipeline_36_80.png" />
<img alt="../../../_images/MachineLearningPipeline_36_81.png" src="../../../_images/MachineLearningPipeline_36_81.png" />
<img alt="../../../_images/MachineLearningPipeline_36_82.png" src="../../../_images/MachineLearningPipeline_36_82.png" />
<img alt="../../../_images/MachineLearningPipeline_36_83.png" src="../../../_images/MachineLearningPipeline_36_83.png" />
<img alt="../../../_images/MachineLearningPipeline_36_84.png" src="../../../_images/MachineLearningPipeline_36_84.png" />
<img alt="../../../_images/MachineLearningPipeline_36_85.png" src="../../../_images/MachineLearningPipeline_36_85.png" />
<img alt="../../../_images/MachineLearningPipeline_36_86.png" src="../../../_images/MachineLearningPipeline_36_86.png" />
<img alt="../../../_images/MachineLearningPipeline_36_87.png" src="../../../_images/MachineLearningPipeline_36_87.png" />
<img alt="../../../_images/MachineLearningPipeline_36_88.png" src="../../../_images/MachineLearningPipeline_36_88.png" />
<img alt="../../../_images/MachineLearningPipeline_36_89.png" src="../../../_images/MachineLearningPipeline_36_89.png" />
<img alt="../../../_images/MachineLearningPipeline_36_90.png" src="../../../_images/MachineLearningPipeline_36_90.png" />
<img alt="../../../_images/MachineLearningPipeline_36_91.png" src="../../../_images/MachineLearningPipeline_36_91.png" />
<img alt="../../../_images/MachineLearningPipeline_36_92.png" src="../../../_images/MachineLearningPipeline_36_92.png" />
<img alt="../../../_images/MachineLearningPipeline_36_93.png" src="../../../_images/MachineLearningPipeline_36_93.png" />
<img alt="../../../_images/MachineLearningPipeline_36_94.png" src="../../../_images/MachineLearningPipeline_36_94.png" />
<img alt="../../../_images/MachineLearningPipeline_36_95.png" src="../../../_images/MachineLearningPipeline_36_95.png" />
<img alt="../../../_images/MachineLearningPipeline_36_96.png" src="../../../_images/MachineLearningPipeline_36_96.png" />
<img alt="../../../_images/MachineLearningPipeline_36_97.png" src="../../../_images/MachineLearningPipeline_36_97.png" />
<img alt="../../../_images/MachineLearningPipeline_36_98.png" src="../../../_images/MachineLearningPipeline_36_98.png" />
<img alt="../../../_images/MachineLearningPipeline_36_99.png" src="../../../_images/MachineLearningPipeline_36_99.png" />
<img alt="../../../_images/MachineLearningPipeline_36_100.png" src="../../../_images/MachineLearningPipeline_36_100.png" />
<img alt="../../../_images/MachineLearningPipeline_36_101.png" src="../../../_images/MachineLearningPipeline_36_101.png" />
<img alt="../../../_images/MachineLearningPipeline_36_102.png" src="../../../_images/MachineLearningPipeline_36_102.png" />
<img alt="../../../_images/MachineLearningPipeline_36_103.png" src="../../../_images/MachineLearningPipeline_36_103.png" />
<img alt="../../../_images/MachineLearningPipeline_36_104.png" src="../../../_images/MachineLearningPipeline_36_104.png" />
<img alt="../../../_images/MachineLearningPipeline_36_105.png" src="../../../_images/MachineLearningPipeline_36_105.png" />
<img alt="../../../_images/MachineLearningPipeline_36_106.png" src="../../../_images/MachineLearningPipeline_36_106.png" />
<img alt="../../../_images/MachineLearningPipeline_36_107.png" src="../../../_images/MachineLearningPipeline_36_107.png" />
<img alt="../../../_images/MachineLearningPipeline_36_108.png" src="../../../_images/MachineLearningPipeline_36_108.png" />
<img alt="../../../_images/MachineLearningPipeline_36_109.png" src="../../../_images/MachineLearningPipeline_36_109.png" />
<img alt="../../../_images/MachineLearningPipeline_36_110.png" src="../../../_images/MachineLearningPipeline_36_110.png" />
<img alt="../../../_images/MachineLearningPipeline_36_111.png" src="../../../_images/MachineLearningPipeline_36_111.png" />
<img alt="../../../_images/MachineLearningPipeline_36_112.png" src="../../../_images/MachineLearningPipeline_36_112.png" />
<img alt="../../../_images/MachineLearningPipeline_36_113.png" src="../../../_images/MachineLearningPipeline_36_113.png" />
<img alt="../../../_images/MachineLearningPipeline_36_114.png" src="../../../_images/MachineLearningPipeline_36_114.png" />
<img alt="../../../_images/MachineLearningPipeline_36_115.png" src="../../../_images/MachineLearningPipeline_36_115.png" />
<img alt="../../../_images/MachineLearningPipeline_36_116.png" src="../../../_images/MachineLearningPipeline_36_116.png" />
<img alt="../../../_images/MachineLearningPipeline_36_117.png" src="../../../_images/MachineLearningPipeline_36_117.png" />
<img alt="../../../_images/MachineLearningPipeline_36_118.png" src="../../../_images/MachineLearningPipeline_36_118.png" />
<img alt="../../../_images/MachineLearningPipeline_36_119.png" src="../../../_images/MachineLearningPipeline_36_119.png" />
<img alt="../../../_images/MachineLearningPipeline_36_120.png" src="../../../_images/MachineLearningPipeline_36_120.png" />
<img alt="../../../_images/MachineLearningPipeline_36_121.png" src="../../../_images/MachineLearningPipeline_36_121.png" />
<img alt="../../../_images/MachineLearningPipeline_36_122.png" src="../../../_images/MachineLearningPipeline_36_122.png" />
<img alt="../../../_images/MachineLearningPipeline_36_123.png" src="../../../_images/MachineLearningPipeline_36_123.png" />
<img alt="../../../_images/MachineLearningPipeline_36_124.png" src="../../../_images/MachineLearningPipeline_36_124.png" />
<img alt="../../../_images/MachineLearningPipeline_36_125.png" src="../../../_images/MachineLearningPipeline_36_125.png" />
<img alt="../../../_images/MachineLearningPipeline_36_126.png" src="../../../_images/MachineLearningPipeline_36_126.png" />
<img alt="../../../_images/MachineLearningPipeline_36_127.png" src="../../../_images/MachineLearningPipeline_36_127.png" />
<img alt="../../../_images/MachineLearningPipeline_36_128.png" src="../../../_images/MachineLearningPipeline_36_128.png" />
<img alt="../../../_images/MachineLearningPipeline_36_129.png" src="../../../_images/MachineLearningPipeline_36_129.png" />
<img alt="../../../_images/MachineLearningPipeline_36_130.png" src="../../../_images/MachineLearningPipeline_36_130.png" />
</div>
</div>
<p>Finally, we compare the true eventlist to the eventlists the model predicted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Score by event WIND</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WIND:&#39;</span><span class="p">)</span>

<span class="n">TPw</span><span class="p">,</span> <span class="n">FNw</span><span class="p">,</span> <span class="n">FPw</span><span class="p">,</span> <span class="n">detectedw</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ICMEsw</span><span class="p">,</span> <span class="n">test_cloudsw</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPw</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPw</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FPw</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPw</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPw</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FNw</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">TPw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Negatives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNw</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPw</span><span class="p">))</span>

<span class="c1"># Score by event STEREO A</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;STEREO A:&#39;</span><span class="p">)</span>

<span class="n">TPa</span><span class="p">,</span> <span class="n">FNa</span><span class="p">,</span> <span class="n">FPa</span><span class="p">,</span> <span class="n">detecteda</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ICMEsa</span><span class="p">,</span> <span class="n">test_cloudsa</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPa</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FPa</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPa</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FNa</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">TPa</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Negatives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNa</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPa</span><span class="p">))</span>

<span class="c1"># Score by event STEREO B</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;STEREO B:&#39;</span><span class="p">)</span>

<span class="n">TPb</span><span class="p">,</span> <span class="n">FNb</span><span class="p">,</span> <span class="n">FPb</span><span class="p">,</span> <span class="n">detectedb</span> <span class="o">=</span> <span class="n">postprocess</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ICMEsb</span><span class="p">,</span> <span class="n">test_cloudsb</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPb</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FPb</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall is:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">TPb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TPb</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">FNb</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">TPb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Negatives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;False Positives&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WIND:
Precision is: 0.6829268292682927
Recall is: 0.6363636363636364
True Positives 28
False Negatives 16
False Positives 13
---------------------
STEREO A:
Precision is: 0.7105263157894737
Recall is: 0.54
True Positives 27
False Negatives 23
False Positives 11
---------------------
STEREO B:
Precision is: 0.7586206896551724
Recall is: 0.5945945945945946
True Positives 22
False Negatives 15
False Positives 7
</pre></div>
</div>
</div>
</div>
<p>We can see, that even though there’s room for improvement, the results of our pipeline are reasonable given the fact, that the problem is quite complicated. Some of the False Positives might even be structures that are actually similar to ICMEs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot FNs, FPs and Detected events</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNw</span><span class="p">)):</span>
    
    <span class="n">FNw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datawin</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;WIND - FalseNegative&#39;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPw</span><span class="p">)):</span>
    
    <span class="n">FPw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datawin</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;WIND - FalsePositive&#39;</span><span class="p">)</span>
    
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">detectedw</span><span class="p">)):</span>
    <span class="n">predstart</span> <span class="o">=</span> <span class="n">TPw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">begin</span>
    <span class="n">predend</span> <span class="o">=</span> <span class="n">TPw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">end</span>
    <span class="n">detectedw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplot</span><span class="p">(</span><span class="n">datawin</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;WIND - Detected-&#39;</span><span class="p">,</span> <span class="n">predstart</span><span class="p">,</span> <span class="n">predend</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNa</span><span class="p">)):</span>
    
    <span class="n">FNa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">dataa</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO A - FalseNegative&#39;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPa</span><span class="p">)):</span>
    
    <span class="n">FPa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">dataa</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO A - FalsePositive&#39;</span><span class="p">)</span>
    
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">detecteda</span><span class="p">)):</span>
    <span class="n">predstart</span> <span class="o">=</span> <span class="n">TPa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">begin</span>
    <span class="n">predend</span> <span class="o">=</span> <span class="n">TPa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">end</span>
    <span class="n">detecteda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplot</span><span class="p">(</span><span class="n">dataa</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;STEREO A - Detected-&#39;</span><span class="p">,</span> <span class="n">predstart</span><span class="p">,</span> <span class="n">predend</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FNb</span><span class="p">)):</span>
    
    <span class="n">FNb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datab</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO B - FalseNegative&#39;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FPb</span><span class="p">)):</span>
    
    <span class="n">FPb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplotnopred</span><span class="p">(</span><span class="n">datab</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;STEREO B - FalsePositive&#39;</span><span class="p">)</span>
    
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">detectedb</span><span class="p">)):</span>
    <span class="n">predstart</span> <span class="o">=</span> <span class="n">TPb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">begin</span>
    <span class="n">predend</span> <span class="o">=</span> <span class="n">TPb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">end</span>
    <span class="n">detectedb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iwfplot</span><span class="p">(</span><span class="n">datab</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;STEREO B - Detected-&#39;</span><span class="p">,</span> <span class="n">predstart</span><span class="p">,</span> <span class="n">predend</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/MachineLearningPipeline_40_0.png" src="../../../_images/MachineLearningPipeline_40_0.png" />
<img alt="../../../_images/MachineLearningPipeline_40_1.png" src="../../../_images/MachineLearningPipeline_40_1.png" />
<img alt="../../../_images/MachineLearningPipeline_40_2.png" src="../../../_images/MachineLearningPipeline_40_2.png" />
<img alt="../../../_images/MachineLearningPipeline_40_3.png" src="../../../_images/MachineLearningPipeline_40_3.png" />
<img alt="../../../_images/MachineLearningPipeline_40_4.png" src="../../../_images/MachineLearningPipeline_40_4.png" />
<img alt="../../../_images/MachineLearningPipeline_40_5.png" src="../../../_images/MachineLearningPipeline_40_5.png" />
<img alt="../../../_images/MachineLearningPipeline_40_6.png" src="../../../_images/MachineLearningPipeline_40_6.png" />
<img alt="../../../_images/MachineLearningPipeline_40_7.png" src="../../../_images/MachineLearningPipeline_40_7.png" />
<img alt="../../../_images/MachineLearningPipeline_40_8.png" src="../../../_images/MachineLearningPipeline_40_8.png" />
<img alt="../../../_images/MachineLearningPipeline_40_9.png" src="../../../_images/MachineLearningPipeline_40_9.png" />
<img alt="../../../_images/MachineLearningPipeline_40_10.png" src="../../../_images/MachineLearningPipeline_40_10.png" />
<img alt="../../../_images/MachineLearningPipeline_40_11.png" src="../../../_images/MachineLearningPipeline_40_11.png" />
<img alt="../../../_images/MachineLearningPipeline_40_12.png" src="../../../_images/MachineLearningPipeline_40_12.png" />
<img alt="../../../_images/MachineLearningPipeline_40_13.png" src="../../../_images/MachineLearningPipeline_40_13.png" />
<img alt="../../../_images/MachineLearningPipeline_40_14.png" src="../../../_images/MachineLearningPipeline_40_14.png" />
<img alt="../../../_images/MachineLearningPipeline_40_15.png" src="../../../_images/MachineLearningPipeline_40_15.png" />
<img alt="../../../_images/MachineLearningPipeline_40_16.png" src="../../../_images/MachineLearningPipeline_40_16.png" />
<img alt="../../../_images/MachineLearningPipeline_40_17.png" src="../../../_images/MachineLearningPipeline_40_17.png" />
<img alt="../../../_images/MachineLearningPipeline_40_18.png" src="../../../_images/MachineLearningPipeline_40_18.png" />
<img alt="../../../_images/MachineLearningPipeline_40_19.png" src="../../../_images/MachineLearningPipeline_40_19.png" />
<img alt="../../../_images/MachineLearningPipeline_40_20.png" src="../../../_images/MachineLearningPipeline_40_20.png" />
<img alt="../../../_images/MachineLearningPipeline_40_21.png" src="../../../_images/MachineLearningPipeline_40_21.png" />
<img alt="../../../_images/MachineLearningPipeline_40_22.png" src="../../../_images/MachineLearningPipeline_40_22.png" />
<img alt="../../../_images/MachineLearningPipeline_40_23.png" src="../../../_images/MachineLearningPipeline_40_23.png" />
<img alt="../../../_images/MachineLearningPipeline_40_24.png" src="../../../_images/MachineLearningPipeline_40_24.png" />
<img alt="../../../_images/MachineLearningPipeline_40_25.png" src="../../../_images/MachineLearningPipeline_40_25.png" />
<img alt="../../../_images/MachineLearningPipeline_40_26.png" src="../../../_images/MachineLearningPipeline_40_26.png" />
<img alt="../../../_images/MachineLearningPipeline_40_27.png" src="../../../_images/MachineLearningPipeline_40_27.png" />
<img alt="../../../_images/MachineLearningPipeline_40_28.png" src="../../../_images/MachineLearningPipeline_40_28.png" />
<img alt="../../../_images/MachineLearningPipeline_40_29.png" src="../../../_images/MachineLearningPipeline_40_29.png" />
<img alt="../../../_images/MachineLearningPipeline_40_30.png" src="../../../_images/MachineLearningPipeline_40_30.png" />
<img alt="../../../_images/MachineLearningPipeline_40_31.png" src="../../../_images/MachineLearningPipeline_40_31.png" />
<img alt="../../../_images/MachineLearningPipeline_40_32.png" src="../../../_images/MachineLearningPipeline_40_32.png" />
<img alt="../../../_images/MachineLearningPipeline_40_33.png" src="../../../_images/MachineLearningPipeline_40_33.png" />
<img alt="../../../_images/MachineLearningPipeline_40_34.png" src="../../../_images/MachineLearningPipeline_40_34.png" />
<img alt="../../../_images/MachineLearningPipeline_40_35.png" src="../../../_images/MachineLearningPipeline_40_35.png" />
<img alt="../../../_images/MachineLearningPipeline_40_36.png" src="../../../_images/MachineLearningPipeline_40_36.png" />
<img alt="../../../_images/MachineLearningPipeline_40_37.png" src="../../../_images/MachineLearningPipeline_40_37.png" />
<img alt="../../../_images/MachineLearningPipeline_40_38.png" src="../../../_images/MachineLearningPipeline_40_38.png" />
<img alt="../../../_images/MachineLearningPipeline_40_39.png" src="../../../_images/MachineLearningPipeline_40_39.png" />
<img alt="../../../_images/MachineLearningPipeline_40_40.png" src="../../../_images/MachineLearningPipeline_40_40.png" />
<img alt="../../../_images/MachineLearningPipeline_40_41.png" src="../../../_images/MachineLearningPipeline_40_41.png" />
<img alt="../../../_images/MachineLearningPipeline_40_42.png" src="../../../_images/MachineLearningPipeline_40_42.png" />
<img alt="../../../_images/MachineLearningPipeline_40_43.png" src="../../../_images/MachineLearningPipeline_40_43.png" />
<img alt="../../../_images/MachineLearningPipeline_40_44.png" src="../../../_images/MachineLearningPipeline_40_44.png" />
<img alt="../../../_images/MachineLearningPipeline_40_45.png" src="../../../_images/MachineLearningPipeline_40_45.png" />
<img alt="../../../_images/MachineLearningPipeline_40_46.png" src="../../../_images/MachineLearningPipeline_40_46.png" />
<img alt="../../../_images/MachineLearningPipeline_40_47.png" src="../../../_images/MachineLearningPipeline_40_47.png" />
<img alt="../../../_images/MachineLearningPipeline_40_48.png" src="../../../_images/MachineLearningPipeline_40_48.png" />
<img alt="../../../_images/MachineLearningPipeline_40_49.png" src="../../../_images/MachineLearningPipeline_40_49.png" />
<img alt="../../../_images/MachineLearningPipeline_40_50.png" src="../../../_images/MachineLearningPipeline_40_50.png" />
<img alt="../../../_images/MachineLearningPipeline_40_51.png" src="../../../_images/MachineLearningPipeline_40_51.png" />
<img alt="../../../_images/MachineLearningPipeline_40_52.png" src="../../../_images/MachineLearningPipeline_40_52.png" />
<img alt="../../../_images/MachineLearningPipeline_40_53.png" src="../../../_images/MachineLearningPipeline_40_53.png" />
<img alt="../../../_images/MachineLearningPipeline_40_54.png" src="../../../_images/MachineLearningPipeline_40_54.png" />
<img alt="../../../_images/MachineLearningPipeline_40_55.png" src="../../../_images/MachineLearningPipeline_40_55.png" />
<img alt="../../../_images/MachineLearningPipeline_40_56.png" src="../../../_images/MachineLearningPipeline_40_56.png" />
</div>
</div>
<p>Last but not least, we plot two well-known evaluation metrics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_recall_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">plot_precision_recall_curve</span>


<span class="c1"># calculate precision-recall curve</span>
<span class="n">precisionw</span><span class="p">,</span> <span class="n">recallw</span><span class="p">,</span> <span class="n">thresholdsw</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">pr_aucw</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">recallw</span><span class="p">,</span> <span class="n">precisionw</span><span class="p">)</span>

<span class="n">precisiona</span><span class="p">,</span> <span class="n">recalla</span><span class="p">,</span> <span class="n">thresholdsa</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">pr_auca</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">recalla</span><span class="p">,</span> <span class="n">precisiona</span><span class="p">)</span>

<span class="n">precisionb</span><span class="p">,</span> <span class="n">recallb</span><span class="p">,</span> <span class="n">thresholdsb</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">pr_aucb</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">recallb</span><span class="p">,</span> <span class="n">precisionb</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precision vs Recall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recallw</span><span class="p">,</span> <span class="n">precisionw</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;WIND - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pr_aucw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recalla</span><span class="p">,</span> <span class="n">precisiona</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;STEREO A - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pr_auca</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recallb</span><span class="p">,</span> <span class="n">precisionb</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;STEREO B - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pr_aucb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Recall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/MachineLearningPipeline_42_0.png" src="../../../_images/MachineLearningPipeline_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>

<span class="c1"># calculate roc curve</span>

<span class="n">fprw</span><span class="p">,</span> <span class="n">tprw</span><span class="p">,</span> <span class="n">thresholdsw</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">fpra</span><span class="p">,</span> <span class="n">tpra</span><span class="p">,</span> <span class="n">thresholdsa</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">fprb</span><span class="p">,</span> <span class="n">tprb</span><span class="p">,</span> <span class="n">thresholdsb</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>

<span class="n">auc_rocw</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultw</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">auc_roca</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resulta</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
<span class="n">auc_rocb</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">],</span> <span class="n">resultb</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Receiver Operating Characteristic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fprw</span><span class="p">,</span> <span class="n">tprw</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;WIND - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">auc_rocw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpra</span><span class="p">,</span> <span class="n">tpra</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;STEREO A - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">auc_roca</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fprb</span><span class="p">,</span> <span class="n">tprb</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;STEREO B - AUC = </span><span class="si">%0.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">auc_rocb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;No skill&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/MachineLearningPipeline_43_0.png" src="../../../_images/MachineLearningPipeline_43_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Part_2/Chapter_1_ICMEsDetection/Tutorial-ICMEs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../ScienceBackground.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Science Background - Interplanetary Coronal Mass Ejections</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Summary.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Summary and Discussion</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Durch The Europlanet ML Team<br/>
    
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>